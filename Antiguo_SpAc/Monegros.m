function u = Monegros(x,y,op)
k_1 = 1.0; k_2 = 0.01; k_3 = 0.02; k_4 = 0.12; k_5 = 0.05;
k_6 = 0.05; k_7 = -0.12; scaling_factor = 0.333;
switch op
    case 'u'
        u = 3 + scaling_factor*(sin(sqrt(k_1+k_2*x.^2 +k_3*y.^2)) + tanh(sin(k_4*x + k_5*y)+sin(k_6*x + k_7*y)));
    case 'dudx'
        u = k_2*x.*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./sqrt(k_2*x.^2 + k_3*y.^2 + k_1) -...
        (k_4*cos(k_4*x + k_5*y) + k_6*cos(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1);
        u = u*scaling_factor;
    case 'dudy'
        u = k_3*y.*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./sqrt(k_2*x.^2 + k_3*y.^2 + k_1) -...
        (k_5*cos(k_4*x + k_5*y) + k_7*cos(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1);
        u = u*scaling_factor;
    case 'd2udx2'
        u = -k_2^2*x.^2.*sin(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1) + ...
        2*(k_4*cos(k_4*x + k_5*y) + k_6*cos(k_6*x + k_7*y)).^2.*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1).*tanh(sin(k_4*x + k_5*y) + sin(k_6*x + k_7*y)) -...
        k_2^2*x.^2.*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1).^(3/2) +...
        (k_4^2*sin(k_4*x + k_5*y) + k_6^2*sin(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1) + k_2*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./sqrt(k_2*x.^2 +...
        k_3*y.^2 + k_1);
        u = u*scaling_factor;
    case 'd2udy2'
        u = -k_3^2*y.^2.*sin(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1) + ...
        2*(k_5*cos(k_4*x + k_5*y) + k_7*cos(k_6*x + k_7*y)).^2.*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1).*tanh(sin(k_4*x + k_5*y) + sin(k_6*x + k_7*y)) -...
        k_3^2*y.^2.*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1).^(3/2) +... 
        (k_5^2*sin(k_4*x + k_5*y) + k_7^2*sin(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) +...
        sin(k_6*x + k_7*y)).^2 - 1) + k_3*cos(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./sqrt(k_2*x.^2 +...
        k_3*y.^2 + k_1);
        u = u*scaling_factor;
    case 'd2udxdy'
        u = -k_2*k_3*x.*y.*sin(sqrt(k_2*x.^2 + k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1) + ...
        2*(k_4*cos(k_4*x + k_5*y) + k_6*cos(k_6*x + k_7*y)).*(k_5*cos(k_4*x + k_5*y) +...
        k_7*cos(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) + sin(k_6*x + k_7*y)).^2 - 1)...
        .*tanh(sin(k_4*x + k_5*y) + sin(k_6*x + k_7*y)) - k_2*k_3*x.*y.*cos(sqrt(k_2*x.^2 + ...
        k_3*y.^2 + k_1))./(k_2*x.^2 + k_3*y.^2 + k_1).^(3/2) + (k_4*k_5*sin(k_4*x + k_5*y) +...
        k_6*k_7*sin(k_6*x + k_7*y)).*(tanh(sin(k_4*x + k_5*y) + sin(k_6*x + k_7*y)).^2 - 1);
        u = u*scaling_factor;
    otherwise
        disp('Error')
end
    
end